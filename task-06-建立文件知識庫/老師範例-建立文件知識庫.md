# 任務 6：建立文件知識庫（老師範例）

> **本範例示範如何使用 AI 工具（NotebookLM、Ollama、Claude）協助建立完整的文件知識庫**

---

## 📋 專案資訊

- **專案名稱**：公司內部文件知識庫建立專案
- **建立日期**：2025年1月20日
- **負責人**：王經理
- **協作人員**：李專員、張工程師
- **知識庫類型**：混合式（雲端 + 本地）

---

## 🎯 專案目標

1. 建立統一的可查詢文件知識庫
2. 提高新進員工的資訊取得效率
3. 減少重複回答常見問題的時間
4. 確保文件資訊的準確性和一致性

---

## 📁 第一階段：文件收集與分類

### 1.1 文件來源

**收集的文件類型：**
- ✅ SOP（標準作業程序）文件：15 份
- ✅ 技術文件：20 份
- ✅ 政策手冊：8 份
- ✅ 常見問題 FAQ：5 份
- ✅ 訓練教材：10 份

**文件格式：**
- PDF：35 份
- Word（.docx）：10 份
- Google Docs：8 份
- Markdown：5 份

### 1.2 文件分類結構

```
公司文件知識庫/
├── SOP 文件/
│   ├── 人力資源 SOP/
│   ├── 財務 SOP/
│   └── 資訊安全 SOP/
├── 技術文件/
│   ├── API 文件/
│   ├── 系統架構文件/
│   └── 開發指南/
├── 政策手冊/
│   ├── 員工手冊/
│   └── 資訊安全政策/
└── 常見問題/
    ├── 新進員工 FAQ/
    └── 技術支援 FAQ/
```

### 1.3 文件審核與標記

**審核重點：**
- ✅ 確認文件版本為最新版本
- ✅ 確認文件完整性（無缺頁或破損）
- ✅ 標記機密文件（不適合上傳到雲端）
- ✅ 移除過期或無效的文件

**分類結果：**
- **可上傳雲端（NotebookLM）**：40 份（公開文件）
- **僅本地使用（Ollama）**：18 份（機密或敏感文件）

---

## 🤖 第二階段：建立知識庫（方法 A：NotebookLM）

### 2.1 NotebookLM 設定

**使用工具：** NotebookLM（Google）

**建立步驟：**

1. **建立新的 Notebook**
   - 登入 NotebookLM：https://notebooklm.google/
   - 點擊「建立新的 Notebook」
   - 命名為「公司文件知識庫 - 公開文件」

2. **上傳文件**
   - 批次上傳 PDF 文件（最多 20 個檔案）
   - 上傳 Word 文件（匯出為 PDF 或直接上傳）
   - 連結 Google Docs（直接匯入）

3. **AI 自動索引**
   - NotebookLM 自動分析文件內容
   - 建立語意索引
   - 生成文件摘要（約 3-5 分鐘）

**上傳結果：**
- ✅ 成功上傳：40 份文件
- ⏱️ 處理時間：約 15 分鐘
- 📊 總頁數：約 500 頁

### 2.2 NotebookLM 功能測試

**測試問題 1：** 「新進員工報到流程是什麼？」

**AI 回答：**
> 根據人力資源 SOP 文件，新進員工報到流程如下：
> 1. 報到前 3 天：HR 發送報到通知和所需文件清單
> 2. 報到當天：提交相關證件、填寫資料表、領取員工證
> 3. 報到後一週：完成線上訓練課程、熟悉公司系統
> 
> 詳細步驟請參考「新進員工 SOP」文件第 3-5 頁。

**驗證結果：** ✅ 回答準確，引用了正確的文件和頁碼

---

**測試問題 2：** 「請假的流程和需要準備的文件是什麼？」

**AI 回答：**
> 根據員工手冊，請假流程如下：
> 1. 事前申請：至少提前 3 天在系統中提交請假申請
> 2. 主管核准：等待直屬主管核准
> 3. 文件準備：請假證明（病假需要醫生證明）
> 
> 相關文件：請假申請表、醫生證明（如適用）
> 
> 參考來源：員工手冊第 12 章「請假與休假管理」

**驗證結果：** ✅ 回答準確，包含流程和所需文件

---

## 🔒 第三階段：建立知識庫（方法 B：Ollama 本地 RAG）

### 3.1 Ollama 安裝與設定

**使用工具：** Ollama（本地 RAG 方案）

**安裝步驟：**

1. **安裝 Ollama**
   ```bash
   # macOS/Linux
   curl -fsSL https://ollama.com/install.sh | sh
   
   # 或下載安裝檔：https://ollama.com/download
   ```

2. **下載語言模型**
   ```bash
   ollama pull llama2
   # 或使用其他模型：mistral, codellama 等
   ```

3. **安裝 RAG 工具（以 LangChain 為例）**
   ```bash
   pip install langchain ollama chromadb
   ```

### 3.2 建立本地知識庫

**Python 程式碼範例：**

```python
from langchain.document_loaders import PyPDFLoader
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.vectorstores import Chroma
from langchain.embeddings import OllamaEmbeddings
from langchain.llms import Ollama
from langchain.chains import RetrievalQA

# 1. 載入文件
loaders = [PyPDFLoader("文件路徑/機密文件1.pdf") for 檔案 in 機密文件列表]
documents = []
for loader in loaders:
    documents.extend(loader.load())

# 2. 分割文件
text_splitter = RecursiveCharacterTextSplitter(chunk_size=1000, chunk_overlap=200)
splits = text_splitter.split_documents(documents)

# 3. 建立向量資料庫
embeddings = OllamaEmbeddings(model="llama2")
vectorstore = Chroma.from_documents(documents=splits, embedding=embeddings)

# 4. 建立問答鏈
llm = Ollama(model="llama2")
qa_chain = RetrievalQA.from_chain_type(
    llm=llm,
    retriever=vectorstore.as_retriever(),
    return_source_documents=True
)
```

**執行結果：**
- ✅ 成功建立本地知識庫
- 📊 索引文件：18 份機密文件
- 💾 儲存位置：本地 Chroma 資料庫
- 🔒 資料安全性：完全不上雲，僅本地存取

### 3.3 本地知識庫測試

**測試問題：** 「資訊安全政策的存取控制規範是什麼？」

**AI 回答：**
> 根據資訊安全政策文件，存取控制規範如下：
> 1. 使用者必須通過身份驗證（帳號密碼 + 雙因素認證）
> 2. 遵循最小權限原則（僅授予必要的存取權限）
> 3. 定期審查和更新存取權限
> 4. 所有存取記錄必須留存至少 90 天
> 
> 詳細規範請參考「資訊安全政策文件」第 5.2 節。

**驗證結果：** ✅ 回答準確，符合政策文件內容

---

## 📝 第四階段：建立使用指南

### 4.1 知識庫使用手冊

**文件名稱：** 公司文件知識庫使用手冊

**內容大綱：**

1. **知識庫簡介**
   - 知識庫的目的和範圍
   - 收錄的文件類型

2. **存取方式**
   - NotebookLM（雲端知識庫）：公開文件
   - Ollama（本地知識庫）：機密文件（需申請權限）

3. **使用指南**
   - 如何提出問題
   - 問題撰寫的技巧
   - 如何驗證回答的準確性

4. **常見問題範例**
   - 預設的問題範例和標準回答

5. **維護與更新**
   - 文件更新的流程
   - 問題回報機制

### 4.2 常見問題 Q&A 文件

| 問題分類 | 問題範例 | 知識庫來源 |
|---------|---------|-----------|
| 新進員工 | 報到流程是什麼？ | NotebookLM - 人力資源 SOP |
| 請假相關 | 請假需要什麼文件？ | NotebookLM - 員工手冊 |
| 技術支援 | API 文件在哪裡？ | NotebookLM - 技術文件 |
| 資訊安全 | 密碼政策是什麼？ | Ollama - 資訊安全政策 |

---

## 🔍 第五階段：測試與驗證

### 5.1 測試計畫

**測試目標：**
- 驗證知識庫的檢索準確性
- 確認回答的完整性和正確性
- 測試不同類型的問題

**測試問題類別：**

1. **事實查詢**（10 題）
   - 範例：「公司的上班時間是幾點？」
   - 預期：直接引用文件中的具體資訊

2. **流程說明**（10 題）
   - 範例：「申請補助的流程是什麼？」
   - 預期：按步驟說明完整流程

3. **綜合查詢**（5 題）
   - 範例：「新進員工在第一週需要完成哪些事情？」
   - 預期：綜合多個文件的資訊

### 5.2 測試結果

**NotebookLM 測試結果：**

| 問題類別 | 測試題數 | 正確回答 | 部分正確 | 不正確 | 準確率 |
|---------|---------|---------|---------|--------|--------|
| 事實查詢 | 10 | 9 | 1 | 0 | 90% |
| 流程說明 | 10 | 8 | 2 | 0 | 80% |
| 綜合查詢 | 5 | 4 | 1 | 0 | 80% |
| **總計** | **25** | **21** | **4** | **0** | **84%** |

**Ollama 本地知識庫測試結果：**

| 問題類別 | 測試題數 | 正確回答 | 部分正確 | 不正確 | 準確率 |
|---------|---------|---------|---------|--------|--------|
| 事實查詢 | 10 | 8 | 2 | 0 | 80% |
| 流程說明 | 10 | 7 | 3 | 0 | 70% |
| 綜合查詢 | 5 | 3 | 2 | 0 | 60% |
| **總計** | **25** | **18** | **7** | **0** | **72%** |

### 5.3 發現的問題與改進

**NotebookLM 發現的問題：**
1. ❌ 某些技術術語的理解不夠準確
   - 改進：補充文件中的術語說明
2. ⚠️ 綜合查詢時可能遺漏部分資訊
   - 改進：優化問題描述，要求更詳細的回答

**Ollama 發現的問題：**
1. ❌ 回答有時不夠完整
   - 改進：調整 chunk_size 參數，優化文件分割
2. ⚠️ 某些文件內容索引不完整
   - 改進：檢查文件格式，確保正確解析

---

## 📊 專案成果總結

### 6.1 建立的知識庫

- ✅ **NotebookLM 知識庫**（雲端）
  - 文件數量：40 份
  - 總頁數：約 500 頁
  - 準確率：84%

- ✅ **Ollama 本地知識庫**
  - 文件數量：18 份
  - 總頁數：約 200 頁
  - 準確率：72%

### 6.2 產出文件

1. ✅ 知識庫使用手冊（已完成）
2. ✅ 常見問題 Q&A 文件（已完成）
3. ✅ 測試報告（已完成）
4. ✅ 維護 SOP（待完成）

### 6.3 效益評估

**時間節省：**
- 新進員工查詢資訊時間：從 30 分鐘 → 5 分鐘（節省 83%）
- 重複回答問題時間：預計每月節省 10 小時

**準確性提升：**
- 資訊一致性：確保所有員工取得相同標準的資訊
- 版本控制：所有回答基於最新版本的文件

---

## 🤖 AI 工具使用說明

本專案使用以下 AI 工具協助建立知識庫：

1. **NotebookLM**（Google）
   - **功能**：雲端文件知識庫，自動索引和問答
   - **使用方式**：上傳文件後，AI 自動建立索引，可立即查詢
   - **優點**：操作簡單、無需程式設計、支援多種文件格式
   - **限制**：需要網路連線、資料上傳到雲端

2. **Ollama**（本地 RAG）
   - **功能**：本地執行的 RAG 系統，資料完全不上雲
   - **使用方式**：使用 Python 和 LangChain 建立向量資料庫
   - **優點**：資料安全性高、可完全控制、無網路需求
   - **限制**：需要技術背景、需要本地安裝和設定

3. **Claude**（文件摘要）
   - **功能**：協助整理文件摘要和結構化內容
   - **使用方式**：上傳文件要求生成摘要或整理重點
   - **優點**：生成高品質的摘要、協助文件分類
   - **應用**：文件預處理、內容驗證

---

## 📝 備註與建議

### 維護計畫

- **定期更新**：每月檢查並更新過期文件
- **問題回報**：建立回報機制，收集使用者的回饋
- **準確性監控**：定期測試知識庫，確保回答準確性

### 未來改進方向

1. **擴充知識庫**：持續新增相關文件
2. **優化模型**：嘗試不同的語言模型，提高準確率
3. **整合系統**：將知識庫整合到公司內部系統
4. **多語言支援**：支援多語言問答

---

*本範例使用 Markdown 格式撰寫，可直接轉換為其他格式（Word、PDF、HTML）*

*專案完成日期：2025年1月20日*
