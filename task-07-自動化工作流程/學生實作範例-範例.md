# 任務 7：自動化工作流程（學生實作範例）

> **本範例示範學生如何實作自動化工作流程**

---

## 📋 專案資訊

- **專案名稱**：課程意見回饋自動分析系統
- **建立日期**：2025年1月20日
- **負責人**：張同學（組長）
- **建立者**：張同學、李同學（共同實作）

### 專案目標
建立一個自動化流程，當同學提交課程意見回饋後，系統自動：
1. 分析回饋內容的情感傾向和關鍵意見
2. 統計每週的意見回饋趨勢
3. 生成每週摘要報告
4. 自動發送報告給老師和助教

---

## 🔧 系統架構

### 使用的工具
- **表單工具**：Google Forms（收集課程意見）
- **資料儲存**：Google Sheets（儲存表單回應）
- **自動化工具**：Google Apps Script（自動化腳本）
- **AI 工具**：ChatGPT 網頁版（手動批次分析，因為 API 需要付費）
- **通知工具**：Gmail（發送報告給老師）

### 流程架構圖

```
同學填寫課程意見表單 → Google Forms 
    ↓
Google Sheets（自動儲存資料）
    ↓
每週一早上 9:00 自動觸發
    ↓
Google Apps Script 讀取本週資料
    ↓
手動批次使用 ChatGPT 分析（因為免費方案）
    ↓
生成每週摘要報告
    ↓
Gmail 自動發送報告給老師和助教
```

---

## 📝 實作過程

### 步驟一：設計表單

**表單內容設計：**

1. **學號**（簡答題，必填）
   - 目的：識別同學身份，避免重複填寫

2. **姓名**（簡答題，必填）
   - 目的：記錄填寫者姓名

3. **對課程的整體滿意度**（單選題）
   - 非常滿意（5分）
   - 滿意（4分）
   - 普通（3分）
   - 不滿意（2分）
   - 非常不滿意（1分）

4. **課程內容難度**（單選題）
   - 太簡單
   - 剛好
   - 有點困難
   - 太困難

5. **課程進度**（單選題）
   - 太快
   - 剛好
   - 太慢

6. **意見回饋**（段落文字）
   - 目的：收集詳細意見和建議

7. **希望改進的部分**（複選題）
   - 課程內容
   - 教學方式
   - 作業安排
   - 評分方式
   - 其他

**Google Forms 設定：**
- 啟用「收集電子郵件地址」（選填）
- 啟用「限制為一個回覆」
- 將回應連結到 Google Sheets

---

### 步驟二：建立資料儲存表

**表單回應 Sheet 結構：**

| 時間戳記 | 電子郵件 | 學號 | 姓名 | 整體滿意度 | 課程難度 | 課程進度 | 意見回饋 | 希望改進 | AI分析 | 情感傾向 | 關鍵意見 |
|---------|---------|------|------|-----------|---------|---------|---------|---------|--------|---------|---------|
| 自動填入 | 自動填入 | 自動填入 | 自動填入 | 自動填入 | 自動填入 | 自動填入 | 自動填入 | 自動填入 | （手動） | （手動） | （手動） |

**建立第二個 Sheet：分析報告摘要**
- 用於儲存每週自動產生的分析報告

---

### 步驟三：撰寫自動化腳本

**腳本功能說明：**

1. **generateWeeklyReport 函數**：生成每週摘要報告
   - 讀取本週的表單回應資料
   - 統計滿意度、難度、進度等數據
   - 生成報告內容
   - 發送郵件給老師

2. **formatReport 函數**：格式化報告內容
   - 將統計資料格式化為易讀的報告

**關鍵程式碼：**

```javascript
// 每週生成報告（設定時間觸發器）
function generateWeeklyReport() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var responseSheet = spreadsheet.getSheetByName('表單回應 1');
  var data = responseSheet.getDataRange().getValues();
  
  // 取得表頭
  var headers = data[0];
  
  // 取得本週的資料（假設從第2行開始是資料）
  var thisWeekData = [];
  var today = new Date();
  var oneWeekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
  
  for (var i = 1; i < data.length; i++) {
    var timestamp = new Date(data[i][0]); // 時間戳記在第一欄
    if (timestamp >= oneWeekAgo) {
      thisWeekData.push(data[i]);
    }
  }
  
  // 統計資料
  var totalCount = thisWeekData.length;
  var avgSatisfaction = calculateAvgSatisfaction(thisWeekData, headers);
  var difficultyDistribution = calculateDifficultyDistribution(thisWeekData, headers);
  var paceDistribution = calculatePaceDistribution(thisWeekData, headers);
  
  // 生成報告
  var report = formatReport(totalCount, avgSatisfaction, difficultyDistribution, paceDistribution, thisWeekData, headers);
  
  // 儲存報告到 Sheet
  var reportSheet = spreadsheet.getSheetByName('分析報告摘要');
  if (reportSheet == null) {
    reportSheet = spreadsheet.insertSheet('分析報告摘要');
    reportSheet.appendRow(['日期', '報告內容']);
  }
  reportSheet.appendRow([new Date(), report]);
  
  // 發送郵件
  sendReportEmail(report);
}

// 計算平均滿意度
function calculateAvgSatisfaction(data, headers) {
  var satisfactionIndex = headers.indexOf('對課程的整體滿意度');
  var total = 0;
  var count = 0;
  
  for (var i = 0; i < data.length; i++) {
    var satisfaction = data[i][satisfactionIndex];
    if (satisfaction) {
      // 將文字轉換為數字（例如：非常滿意 = 5）
      var score = satisfactionToNumber(satisfaction);
      total += score;
      count++;
    }
  }
  
  return count > 0 ? (total / count).toFixed(2) : 0;
}

// 格式化報告
function formatReport(totalCount, avgSatisfaction, difficultyDistribution, paceDistribution, data, headers) {
  var report = '=== 課程意見回饋分析報告 ===\n\n';
  report += '統計期間：本週\n';
  report += '總回饋數：' + totalCount + ' 筆\n\n';
  
  report += '【整體滿意度】\n';
  report += '平均滿意度：' + avgSatisfaction + ' 分（5分滿分）\n\n';
  
  report += '【課程難度分布】\n';
  for (var key in difficultyDistribution) {
    report += key + '：' + difficultyDistribution[key] + ' 人\n';
  }
  report += '\n';
  
  report += '【課程進度分布】\n';
  for (var key in paceDistribution) {
    report += key + '：' + paceDistribution[key] + ' 人\n';
  }
  report += '\n';
  
  report += '【詳細回饋內容】\n';
  var feedbackIndex = headers.indexOf('意見回饋');
  for (var i = 0; i < Math.min(data.length, 5); i++) { // 只顯示前5筆
    if (data[i][feedbackIndex]) {
      report += (i + 1) + '. ' + data[i][feedbackIndex] + '\n\n';
    }
  }
  
  return report;
}

// 發送郵件
function sendReportEmail(report) {
  var email = 'teacher@example.com'; // 老師的郵件地址
  var subject = '課程意見回饋分析報告 - ' + Utilities.formatDate(new Date(), Session.getScriptTimeZone(), 'yyyy/MM/dd');
  
  MailApp.sendEmail({
    to: email,
    subject: subject,
    body: report
  });
}
```

**遇到的問題與解決方式：**

- **問題 1**：不知道如何讀取特定時間範圍的資料
  - **解決方式**：查閱 Google Apps Script 文件，學習使用 Date 物件計算時間範圍

- **問題 2**：統計資料時不知道如何處理文字選項
  - **解決方式**：建立轉換函數，將文字選項轉換為數值進行統計

---

### 步驟四：設定 API 整合

**使用的 API：**
- **免費方案**：不直接使用 API，改為手動批次使用 ChatGPT 網頁版分析

**手動分析流程：**
1. 每週一執行自動化腳本後，手動匯出本週的回饋內容
2. 批次貼到 ChatGPT 網頁版進行分析
3. 將分析結果手動貼回 Google Sheets

**未來改進方向：**
- 如果有預算，可以申請 ChatGPT API，實現完全自動化
- 或使用 Google Gemini API（有免費額度）

---

### 步驟五：設定觸發器

**觸發器設定：**

1. **每週報告觸發器**
   - 類型：時間驅動
   - 頻率：每週
   - 執行時間：每週一早上 9:00
   - 執行函數：generateWeeklyReport
   - 執行時機：每週一自動執行，生成上週的報告

**設定步驟：**
1. 在 Google Apps Script 編輯器中
2. 點選左側的「觸發條件」圖示
3. 點選「新增觸發條件」
4. 選擇「generateWeeklyReport」函數
5. 選擇「時間驅動」
6. 選擇「週計時器」
7. 選擇「每週一」和「早上 9:00」

---

### 步驟六：測試與優化

**測試流程：**

1. **測試表單提交**
   - 提交測試回饋表單
   - 確認資料正確寫入 Google Sheets
   - 結果：✅ 正常運作

2. **測試報告生成**
   - 手動執行 generateWeeklyReport 函數
   - 確認報告內容完整
   - 確認郵件發送成功
   - 結果：✅ 報告格式正確，郵件發送成功

3. **測試 AI 分析（手動）**
   - 將回饋內容貼到 ChatGPT 進行分析
   - 確認分析結果有用
   - 結果：✅ 分析結果準確，能提取關鍵意見

**優化改進：**
- 改進報告格式，讓內容更易讀
- 增加更多統計圖表（如圓餅圖）
- 優化郵件內容格式

---

## 📊 執行結果

### 實際執行範例

**表單回應範例：**

| 時間 | 學號 | 姓名 | 滿意度 | 難度 | 進度 | 意見回饋 |
|------|------|------|--------|------|------|---------|
| 2025/1/15 | B123456 | 王同學 | 4 | 剛好 | 剛好 | 課程內容很實用，老師講解清楚 |
| 2025/1/16 | B123457 | 李同學 | 3 | 有點困難 | 太快 | 希望能放慢進度，有些地方跟不上 |
| 2025/1/17 | B123458 | 陳同學 | 5 | 剛好 | 剛好 | 非常喜歡這門課，學到很多 |

**AI 分析結果範例（使用 ChatGPT 手動分析）：**

**王同學的回饋分析：**
- **情感傾向**：正面
- **關鍵意見**：
  1. 對課程內容和老師講解表示肯定
  2. 認為課程實用
  3. 整體滿意度高
- **摘要**：正面回饋，肯定課程品質

**李同學的回饋分析：**
- **情感傾向**：中性偏負面
- **關鍵意見**：
  1. 認為課程難度偏高
  2. 建議放慢進度
  3. 希望調整教學步調
- **建議**：考慮放慢進度或增加輔助資源

### 自動化報告範例

**2025年1月第3週課程意見回饋分析報告**

**統計摘要：**
- 本週總回饋數：12 筆
- 平均滿意度：3.8 分（5分滿分）

**課程難度分布：**
- 太簡單：1 人
- 剛好：8 人
- 有點困難：3 人
- 太困難：0 人

**課程進度分布：**
- 太快：2 人
- 剛好：9 人
- 太慢：1 人

**關鍵發現：**
1. **多數同學滿意課程**：平均滿意度 3.8 分，整體正面
2. **難度適中**：8 位同學認為難度剛好，3 位認為有點困難
3. **進度需微調**：2 位同學認為進度太快，建議稍微放慢

**詳細回饋內容：**
1. 課程內容很實用，老師講解清楚
2. 希望能放慢進度，有些地方跟不上
3. 非常喜歡這門課，學到很多
4. 希望增加更多實作練習
5. 作業難度適中，但數量可以減少一些

**行動項目：**
1. 考慮稍微放慢進度，照顧學習較慢的同學
2. 增加輔助學習資源，幫助有困難的同學
3. 評估作業數量，適度調整

---

## 🤖 AI 工具使用記錄

**使用的 AI 工具：**
- ✅ ChatGPT 網頁版（手動批次分析）
- ❌ ChatGPT API（未使用，因為需要付費）

**使用流程：**
1. **步驟 1**：每週一執行自動化腳本，匯出本週的回饋內容
2. **步驟 2**：將所有回饋內容整理成一個文件
3. **步驟 3**：貼到 ChatGPT 網頁版，使用以下 Prompt 進行分析：
   ```
   請分析以下課程意見回饋：
   
   [貼上所有回饋內容]
   
   請提供：
   1. 整體情感傾向（正面/中性/負面）
   2. 關鍵意見摘要（列出 5-10 點）
   3. 具體建議（如有）
   4. 需要優先處理的問題（如有）
   
   請以結構化的方式呈現。
   ```
4. **步驟 4**：將 ChatGPT 的分析結果整理後，手動貼回 Google Sheets
5. **步驟 5**：檢查並修正分析結果，確保準確性

**AI 工具的優缺點：**
- **優點**：
  - ChatGPT 網頁版免費使用，不需要 API 費用
  - 分析結果準確，能理解語意和情感
  - 能提取關鍵意見，節省手動整理的時間
- **需要改進的地方**：
  - 需要手動批次處理，無法完全自動化
  - 分析結果需要人工檢查和修正
  - 如果回饋數量很多，需要分批處理

**未來改進方向：**
- 如果有預算，可以申請 ChatGPT API 實現完全自動化
- 或使用 Google Gemini API（有免費額度）進行自動化分析

---

## 💡 學習心得與反思

**實作過程中的收穫：**
- 學會使用 Google Apps Script 建立自動化流程
- 學會設計表單和資料儲存結構
- 學會設定時間觸發器
- 學會整合 AI 工具進行資料分析
- 了解自動化工作流程的設計和實作

**遇到的困難與解決：**
- **困難 1**：不熟悉 JavaScript 語法
  - **解決方式**：查閱 Google Apps Script 官方文件和範例，逐步學習
  - **學到的經驗**：Google Apps Script 使用 JavaScript，需要先熟悉基本語法

- **困難 2**：不知道如何設定觸發器
  - **解決方式**：觀看 YouTube 教學影片，學習觸發器設定方法
  - **學到的經驗**：觸發器需要正確設定，否則自動化無法運作

- **困難 3**：AI 分析需要手動處理，無法完全自動化
  - **解決方式**：採用半自動化方案，手動批次處理 AI 分析
  - **學到的經驗**：免費方案有使用限制，需要根據預算選擇適合的方案

**未來改進方向：**
- 申請 ChatGPT API，實現完全自動化分析
- 改進報告格式，增加視覺化圖表
- 增加更多統計分析功能
- 優化郵件通知內容，讓資訊更清晰

---

## ⚠️ 注意事項

**成本控制：**
- 目前使用免費方案（ChatGPT 網頁版），沒有 API 費用
- 如果未來要使用 API，需要控制使用額度，避免超支
- 建議使用 gpt-3.5-turbo 而非 gpt-4（成本較低）

**資料隱私：**
- 學生的學號和姓名等個人資訊需要妥善保護
- 確保只有授權人員可以存取資料
- 遵守資料保護法規

**錯誤處理：**
- 設定錯誤處理機制，避免腳本執行失敗
- 定期檢查自動化流程是否正常運作
- 保留錯誤日誌，方便除錯

**其他注意事項：**
- 定期備份資料
- 定期檢查觸發器是否正常執行
- 根據實際使用情況調整自動化流程

---

## 📝 備註

- 本專案使用免費方案，AI 分析部分需要手動處理
- 如果預算允許，可以申請 API 實現完全自動化
- 可以參考 Google Apps Script 官方文件學習更多功能
- 相關資源：Google Apps Script 教學、ChatGPT 使用教學

---

*本文件使用 Markdown 格式撰寫*
